(function(e){function t(t){for(var r,i,c=t[0],u=t[1],s=t[2],p=0,d=[];p<c.length;p++)i=c[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,c=1;c<n.length;c++){var u=n[c];0!==o[u]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={app:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var l=u;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"168a":function(e,t,n){"use strict";n("d427")},"42f9":function(e,t,n){"use strict";n("d65d")},5298:function(e,t,n){"use strict";n("577e")},"577e":function(e,t,n){},7415:function(e,t,n){"use strict";n("7a46")},"7a46":function(e,t,n){},ad83:function(e,t,n){"use strict";n("d803")},cd49:function(e,t,n){"use strict";n.r(t),n.d(t,"bootstrap",(function(){return He})),n.d(t,"mount",(function(){return ze})),n.d(t,"unmount",(function(){return Je}));var r=n("1da1"),o=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("96cf"),n("7a23"));function a(e,t){var n=Object(o["O"])("router-view");return Object(o["F"])(),Object(o["j"])(n)}n("ad83");const i={};i.render=a;var c=i,u=n("6c02"),s=Object(o["hb"])("data-v-23062d57");Object(o["I"])("data-v-23062d57");var l={class:"home"};Object(o["G"])();var p=s((function(e,t,n,r,a,i){var c=Object(o["O"])("BluePrintPanel"),u=Object(o["O"])("PixelShowPanel");return Object(o["F"])(),Object(o["j"])("div",l,[Object(o["n"])(c,{ref:"refBluePrintPanel"},null,512),Object(o["n"])(u,{pixels:e.pixelArr,onHandleStop:e.handleStop,onHandleRestart:e.handleRestart},null,8,["pixels","onHandleStop","onHandleRestart"])])})),d=n("5530"),f=Object(o["hb"])("data-v-1bb12ad7");Object(o["I"])("data-v-1bb12ad7");var v={class:"pixel-show-panel"},h=Object(o["m"])(" 像素面板 "),b={class:"surface pixel-show-panel-surface"},y={class:"btn-box"},j=Object(o["n"])("div",{id:"matterShowPanel"},[Object(o["n"])("canvas",{id:"showPanel",class:"matter-canvas"})],-1);Object(o["G"])();var O=f((function(e,t,n,r,a,i){return Object(o["F"])(),Object(o["j"])("div",v,[h,Object(o["n"])("div",b,[(Object(o["F"])(!0),Object(o["j"])(o["b"],null,Object(o["M"])(e.pixels,(function(e,t){return Object(o["F"])(),Object(o["j"])("div",{key:t,class:"pixel-item",style:{"background-color":e}},null,4)})),128))]),Object(o["n"])("div",y,[Object(o["n"])("span",{class:"icon-btn text",onClick:t[1]||(t[1]=function(){return e.handleRestart&&e.handleRestart.apply(e,arguments)})},"start"),Object(o["n"])("span",{class:"icon-btn text",style:{"margin-left":"20px"},onClick:t[2]||(t[2]=function(){return e.handleStop&&e.handleStop.apply(e,arguments)})},"pause")]),j])})),m=(n("a9e3"),n("d3b7"),n("25f0"),16),w=n("5502"),g=Object(o["o"])({name:"PixelShowPanel",props:{unit:{type:Number,default:m}},emits:["handleRestart","handleStop"],setup:function(e,t){var n=t.emit,r=Object(w["b"])();document.body.style.setProperty("--unit",e.unit.toString());var a=Object(o["J"])({}),i=Object(o["h"])((function(){return r.state.pixels}));function c(){console.log("handleRestart"),n("handleRestart")}function u(){n("handleStop")}return Object(d["a"])({handleRestart:c,handleStop:u,pixels:i},Object(o["V"])(a))}});n("42f9"),n("168a");g.render=O,g.__scopeId="data-v-1bb12ad7";var P=g,S=Object(o["hb"])("data-v-76729526");Object(o["I"])("data-v-76729526");var x={class:"blue-print-box"};Object(o["G"])();var k=S((function(e,t,n,r,a,i){return Object(o["F"])(),Object(o["j"])("div",x)})),_=n("2909"),R=(n("159b"),n("84a2")),G=n.n(R),M=G()((function(e){var t;null===(t=window.parent)||void 0===t||t.postMessage({msg:"draw",data:e},"*")}),50),B=Object(w["a"])({state:{canvasWidth:16,canvasHeight:16,pixels:Object(o["u"])(new Array(256))},mutations:{commitPixels:function(e,t){e.pixels=t},commitCanvasSize:function(e,t){e.canvasWidth=t[0],e.canvasHeight=t[1]}},actions:{updatePixels:function(e,t){var n=e.commit;n("commitPixels",t),M(t)}},modules:{}}),T=B;function L(){return Object(w["b"])()}var C=n("b8bf"),A=window,E=(A.LGraph,A.LGraphCanvas,A.LiteGraph,50);var H=C["Events"],I=C["Engine"],z=C["Render"],N=(C["Runner"],C["Bodies"]),J=C["Composite"],F=(C["Body"],I.create());function V(e){if(F.gravity.y=5,H.on(F,"collisionStart",(function(e){for(var t=e.pairs,n=0;n<t.length;n++){var r=t[n];("bird"===r.bodyA.label&&"wall"===r.bodyB.label||"bird"===r.bodyB.label&&"wall"===r.bodyA.label)&&(console.log("碰撞!",t),alert("game over"))}})),e){var t=document.getElementById("showPanel"),n=z.create({canvas:t,element:document.getElementById("matterShowPanel")||void 0,engine:F,options:{width:800,height:800}});z.run(n)}}function W(){I.update(F,1e3/60)}n("4de4"),n("b0c0");var D,q=window;q.LiteGraph;(function(e){e["input"]="input",e["output"]="output"})(D||(D={}));var K=50;function U(e){e.leaves&&e.leaves.length&&Q.apply(this,[e.leaves]),Y.apply(this,[e])}function Q(e){for(var t=0;t<e.length;t++){var n=e[t];n.type===D.input?this.addInput(n.name,n.action):n.type===D.output&&this.addOutput(n.name,n.action)}}function Y(e){this.properties=Object.assign({color:"#000",pos:[1,1],canBroken:!1,canDestroy:!1,withGravity:!1},e.properties),this.size=[40,40],this.title=e.title}var $,X="object/bird",Z="object/wall",ee="events/screenClick",te=window,ne=te.LiteGraph;(function(e){e["jump"]="跳跃"})($||($={}));var re={title:"小鸟",nodeType:X,properties:{canShow:!0,withGravity:!0,canBroken:!0,color:"#f44336"},leaves:[{type:"input",name:$.jump,action:ne.ACTION}]};function oe(){function e(){U.apply(this,[re])}e.prototype.onAction=function(e,t){e===$.jump&&(C["Body"].setStatic(this.properties.body,!1),C["Body"].setVelocity(this.properties.body,{x:0,y:-.6*K}),this.properties.withGravity=!0)},ne.registerNodeType(re.nodeType,e)}var ae=window,ie=ae.LiteGraph,ce={title:"墙壁",nodeType:Z,properties:{canShow:!0,canBroken:!0,canDestroy:!0,color:"#f44336"}};function ue(){function e(){U.apply(this,[ce]),this.size=[80,80]}ie.registerNodeType(ce.nodeType,e)}var se=n("de79"),le=window,pe=le.LiteGraph,de={title:"屏幕点击",nodeType:ee,properties:{color:"#f44336"},leaves:[{type:"output",name:"屏幕点击",action:pe.EVENT}]};function fe(){function e(){U.apply(this,[de]),this.size=[120,40]}var t=new se["Event"];function n(e){e||window.event;t.emit("click")}function r(e){this.triggerSlot(0,e)}e.prototype.onAdded=function(){var e=document.querySelector(".pixel-show-panel-surface");null===e||void 0===e||e.addEventListener("click",n)},e.prototype.onRemoved=function(){var e=document.querySelector(".pixel-show-panel-surface");null===e||void 0===e||e.removeEventListener("click",n)},e.prototype.onConnectionsChange=function(e,n,o,a,i){o?t.on(r.bind(this)):t.off(r.bind(this))},pe.registerNodeType(de.nodeType,e)}var ve=window,he=ve.LGraph,be=(ve.LGraphCanvas,ve.LiteGraph,Object(o["u"])(new he));function ye(){oe(),ue(),fe();var e=window.gameJson||'{"last_node_id":2,"last_link_id":1,"nodes":[{"id":1,"type":"object/bird","pos":[160,120],"size":[40,40],"flags":{},"order":1,"mode":0,"inputs":[{"name":"跳跃","type":-1,"link":1}],"title":"小鸟","properties":{"color":"#f44336","pos":[1,1],"canBroken":true,"canDestroy":false,"withGravity":true,"canShow":true}},{"id":2,"type":"events/screenClick","pos":[80,240],"size":[160,40],"flags":{},"order":0,"mode":0,"outputs":[{"name":"屏幕点击时","type":-1,"links":[1]}],"properties":{}}],"links":[[1,2,0,1,0,-1]],"groups":[],"config":{},"extra":{},"version":0.4}';be.configure(JSON.parse(e))}function je(){return be._nodes.filter((function(e){var t;return null===(t=e.properties)||void 0===t?void 0:t.canShow}))}function Oe(e){var t=Pe(e.pos);e.enginePos=t,e.properties.pos=Object(_["a"])(t),e.renderPos=Se(t),e.renderSize=ke(e.size)}function me(e,t){e.enginePos=t,e.properties.pos=Object(_["a"])(t),e.renderPos=Se(t)}function we(e,t){var n,r=(null===(n=e.properties)||void 0===n?void 0:n.color)||"#000";if(e.renderSize)for(var o=e.renderSize,a=0;a<o[1];a++)for(var i=0;i<o[0];i++)t[(e.renderPos[1]+a)*be.canvasWidth+e.renderPos[0]+i]=r}function ge(e){var t=xe(e.size),n={};switch(e.nodeType){case X:n={label:X,frictionAir:.01};break;case Z:n={isStatic:!0,label:Z};break}e.properties.body=N.rectangle(e.enginePos[0]+Math.round(t[0]/2),e.enginePos[1]+Math.round(t[1]/2),t[0],t[1],n),J.add(F.world,[e.properties.body])}function Pe(e){return[Math.round((e[0]-40)/40)*K,Math.round((e[1]-40)/40)*K]}function Se(e){return[Math.floor(e[0]/K),Math.min((null===be||void 0===be?void 0:be.canvasHeight)-1||15,Math.floor(e[1]/K))]}function xe(e){return[Math.round(e[0]/40)*K,Math.round(e[1]/40)*K]}function ke(e){return[Math.round(e[0]/40),Math.round(e[1]/40)]}be.canvasHeight=16,be.canvasWidth=16;var _e=window,Re=(_e.LGraph,_e.LGraphCanvas,_e.LiteGraph,Object(o["o"])({name:"BluePrintPanel",components:{},setup:function(){var e=L(),t=e.state,n=Object(o["J"])({showEdit:!1,editingNode:{},graphObj:Object(o["u"])({}),handleRestart:function(){}});function r(t){e.dispatch("updatePixels",t)}return Object(o["C"])((function(){V(),n.graphObj=Object(o["u"])(be),ye();var e=t.canvasHeight*E,a=t.canvasWidth*t.canvasHeight;n.handleRestart=function(){be.stop(),setTimeout((function(){var e=je();J.clear(F.world,!1);var t=N.rectangle(400,850,800,100,{isStatic:!0});J.add(F.world,[t]),e.forEach((function(e){Oe(e),ge(e)})),be.start()}),100)},be.onAfterStep=function(){W();var t=je(),n=new Array(a);t.forEach((function(t){var r,o=Object(_["a"])(t.properties.pos);null!==(r=t.properties)&&void 0!==r&&r.withGravity&&(o[1]=Math.min(e,Math.floor(t.properties.body.position.y))),me(t,o),we(t,n)})),r(n)}})),Object(d["a"])({},Object(o["V"])(n))}}));n("7415");Re.render=k,Re.__scopeId="data-v-76729526";var Ge=Re,Me=Object(o["o"])({name:"Home",components:{PixelShowPanel:P,BluePrintPanel:Ge},setup:function(){var e=16,t=Object(o["J"])({pixelArr:new Array(e*e)}),n=Object(o["K"])(null);function r(){var e;n.value&&(null===(e=n.value)||void 0===e||e.handleRestart())}function a(){var e;n.value&&(null===(e=n.value)||void 0===e||e.handleStop())}return Object(d["a"])({refBluePrintPanel:n,handleRestart:r,handleStop:a},Object(o["V"])(t))}});n("5298");Me.render=p,Me.__scopeId="data-v-23062d57";var Be=Me,Te=[{path:"/",name:"Home",component:Be}],Le=Object(u["a"])({history:Object(u["b"])(""),routes:Te}),Ce=n("3fd4");n("7dd6");n.p=window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__;var Ae=null;function Ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.container;Ae=Object(o["i"])(c).use(T).use(Le).use(Ce["a"]).mount(t&&t.querySelector("#app")||"#app")}function He(){return Ie.apply(this,arguments)}function Ie(){return Ie=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("[vue] vue app bootstraped");case 1:case"end":return e.stop()}}),e)}))),Ie.apply(this,arguments)}function ze(e){return Ne.apply(this,arguments)}function Ne(){return Ne=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("[vue] props from main framework",t),Ee(t);case 2:case"end":return e.stop()}}),e)}))),Ne.apply(this,arguments)}function Je(){return Fe.apply(this,arguments)}function Fe(){return Fe=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("[vue] vue app unmount"),Ae.unmount(),Ae.$el.innerHTML="",Ae=null;case 4:case"end":return e.stop()}}),e)}))),Fe.apply(this,arguments)}Ee()},d427:function(e,t,n){},d65d:function(e,t,n){},d803:function(e,t,n){}});